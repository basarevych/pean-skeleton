#!/usr/bin/env node

/**
 * Start web server
 */

'use strict'

var app = require('../app');
var locator = require('node-service-locator');

// check requirements
console.log("==> Checking Postgres...");
var db = locator.get('user-repository').getClient();
db.connect(function (err) {
    if (err) {
        console.error(err);
        process.exit(1);
    }

    var httpServer = locator.get('http-server');
    httpServer.start();
    console.log("=> HTTP server started");
    locator.register('http-server', httpServer);

    var socketServer = locator.get('socket-server');
    socketServer.start();
    console.log("=> Socket server started");
    locator.register('socket-server', socketServer);
});
